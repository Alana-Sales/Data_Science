# -*- coding: utf-8 -*-
"""Bank Churn.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1WiMrtC4oAPdR3fZOQxSxlX3YGoagYsIl

# üìä **Entrega #01: An√°lise Explorat√≥ria de Dados (EDA)**  
### üöÄ Conjunto de Dados: Bank Churn (Rotatividade Banc√°ria)  
**Metodologia:** CRISP-DM ‚Äî Fase: Entendimento dos Dados

---

## üë• **DataStorm**
- Filipe Cayres Kelmer (cayresfilipe@gmail.com)
- Maria Naiara Lima Flor (maria.naiara.lima@gmail.com)
- Clara Alyne de Aguiar (claraalyneaguiar04@gmail.com)
- Neiviene Costa (neive0009@gmail.com)
- Alana Silva Sales (alanasilvasales37@gmail.com)
"""

# Importar bibliotecas
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

# Configurar visualiza√ß√µes
sns.set(style="whitegrid")
pd.set_option('display.max_columns', None)

# Carregar dataset
url = 'https://raw.githubusercontent.com/atlantico-academy/datasets/refs/heads/main/churn.csv'
df = pd.read_csv(url)

# Visualizar as primeiras linhas
df.head()

# üìë Dicion√°rio de Dados - An√°lise Explorat√≥ria

import pandas as pd

df_dict = pd.DataFrame([
    {
        "Vari√°vel": "RowNumber",
        "Descri√ß√£o": "√çndice da linha no dataset (n√∫mero sequencial).",
        "Tipo": "Quantitativa",
        "Subtipo": "Discreta",
        "Relev√¢ncia": "N√£o √∫til"
    },
    {
        "Vari√°vel": "CustomerId",
        "Descri√ß√£o": "Identificador √∫nico de cada cliente.",
        "Tipo": "Qualitativa",
        "Subtipo": "Nominal",
        "Relev√¢ncia": "N√£o √∫til"
    },
    {
        "Vari√°vel": "Surname",
        "Descri√ß√£o": "Sobrenome do cliente.",
        "Tipo": "Qualitativa",
        "Subtipo": "Nominal",
        "Relev√¢ncia": "N√£o √∫til"
    },
    {
        "Vari√°vel": "CreditScore",
        "Descri√ß√£o": "Pontua√ß√£o de cr√©dito do cliente.",
        "Tipo": "Quantitativa",
        "Subtipo": "Cont√≠nua",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "Geography",
        "Descri√ß√£o": "Pa√≠s de resid√™ncia do cliente.",
        "Tipo": "Qualitativa",
        "Subtipo": "Nominal",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "Gender",
        "Descri√ß√£o": "Sexo do cliente.",
        "Tipo": "Qualitativa",
        "Subtipo": "Nominal",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "Age",
        "Descri√ß√£o": "Idade do cliente (em anos).",
        "Tipo": "Quantitativa",
        "Subtipo": "Cont√≠nua",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "Tenure",
        "Descri√ß√£o": "Tempo (em anos) que o cliente √© fiel ao banco.",
        "Tipo": "Quantitativa",
        "Subtipo": "Discreta",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "Balance",
        "Descri√ß√£o": "Saldo dispon√≠vel na conta banc√°ria do cliente.",
        "Tipo": "Quantitativa",
        "Subtipo": "Cont√≠nua",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "NumOfProducts",
        "Descri√ß√£o": "Quantidade de produtos banc√°rios adquiridos.",
        "Tipo": "Quantitativa",
        "Subtipo": "Discreta",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "HasCrCard",
        "Descri√ß√£o": "Possui cart√£o de cr√©dito? (1 = Sim, 0 = N√£o)",
        "Tipo": "Qualitativa",
        "Subtipo": "Nominal",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "IsActiveMember",
        "Descri√ß√£o": "Cliente √© ativo? (1 = Sim, 0 = N√£o)",
        "Tipo": "Qualitativa",
        "Subtipo": "Nominal",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "EstimatedSalary",
        "Descri√ß√£o": "Sal√°rio estimado do cliente (em moeda local).",
        "Tipo": "Quantitativa",
        "Subtipo": "Cont√≠nua",
        "Relev√¢ncia": "√ötil"
    },
    {
        "Vari√°vel": "Exited",
        "Descri√ß√£o": "Cliente encerrou o relacionamento com o banco? (1 = Sim, 0 = N√£o).",
        "Tipo": "Qualitativa",
        "Subtipo": "Nominal",
        "Relev√¢ncia": "√ötil (vari√°vel alvo)"
    }
])

# Exibe o dicion√°rio de dados
df_dict

"""## üìë Descri√ß√£o dos Dados

### üìñ Dicion√°rio de Dados
| Vari√°vel            | Descri√ß√£o                                              | Tipo         | Subtipo  | Relev√¢ncia para An√°lise        |
| ------------------- | ------------------------------------------------------ | ------------ | -------- | ------------------------------ |
| **RowNumber**       | √çndice da linha (n√∫mero sequencial)                    | Quantitativa | Discreta | N√£o √∫til (identificador)       |
| **CustomerId**      | Identificador √∫nico do cliente                         | Qualitativa  | Nominal  | N√£o √∫til (identificador)       |
| **Surname**         | Sobrenome do cliente                                   | Qualitativa  | Nominal  | N√£o √∫til (sem valor anal√≠tico) |
| **CreditScore**     | Pontua√ß√£o de cr√©dito do cliente                        | Quantitativa | Cont√≠nua | √ötil                           |
| **Geography**       | Pa√≠s de resid√™ncia do cliente                          | Qualitativa  | Nominal  | √ötil                           |
| **Gender**          | G√™nero do cliente                                      | Qualitativa  | Nominal  | √ötil                           |
| **Age**             | Idade do cliente                                       | Quantitativa | Cont√≠nua | √ötil                           |
| **Tenure**          | Tempo de perman√™ncia como cliente (anos)               | Quantitativa | Discreta | √ötil                           |
| **Balance**         | Saldo da conta banc√°ria                                | Quantitativa | Cont√≠nua | √ötil                           |
| **NumOfProducts**   | N√∫mero de produtos banc√°rios contratados               | Quantitativa | Discreta | √ötil                           |
| **HasCrCard**       | Possui cart√£o de cr√©dito (1 = Sim, 0 = N√£o)            | Qualitativa  | Nominal  | √ötil                           |
| **IsActiveMember**  | √â membro ativo (1 = Sim, 0 = N√£o)                      | Qualitativa  | Nominal  | √ötil                           |
| **EstimatedSalary** | Sal√°rio estimado do cliente                            | Quantitativa | Cont√≠nua | √ötil                           |
| **Exited**          | Indicador de sa√≠da (1 = Saiu do banco, 0 = Permaneceu) | Qualitativa  | Nominal  | √ötil (vari√°vel alvo)

## üìä An√°lise Univariada

Exploramos cada vari√°vel individualmente para entender distribui√ß√£o e outliers.
"""

# Estat√≠sticas descritivas
df.describe()

# Histogramas para vari√°veis quantitativas
quant_vars = ['CreditScore', 'Age', 'Tenure', 'Balance', 'NumOfProducts', 'EstimatedSalary']

for var in quant_vars:
    plt.figure(figsize=(8,4))
    sns.histplot(df[var], kde=True, bins=30)
    plt.title(f'Distribui√ß√£o de {var}')
    plt.show()

# Tabelas de frequ√™ncia e contagens para qualitativas
qual_vars = ['Geography', 'Gender', 'HasCrCard', 'IsActiveMember', 'Exited']

for var in qual_vars:
    print(f'\nFrequ√™ncia de {var}:\n')
    print(df[var].value_counts())
    sns.countplot(x=df[var])
    plt.title(f'Contagem de {var}')
    plt.show()

"""## üîó An√°lise Bivariada

Exploramos as rela√ß√µes entre pares de vari√°veis para identificar padr√µes.


"""

# Matriz de correla√ß√£o apenas para colunas num√©ricas
num_df = df.select_dtypes(include=['float64', 'int64'])
plt.figure(figsize=(10,8))
sns.heatmap(num_df.corr(), annot=True, cmap='coolwarm')
plt.title('Matriz de Correla√ß√£o')
plt.show()

# Scatterplot Age vs Balance
sns.scatterplot(x='Age', y='Balance', hue='Exited', data=df)
plt.title('Idade vs. Saldo, colorido por Churn')
plt.show()

# Boxplot Balance por Geography
sns.boxplot(x='Geography', y='Balance', hue='Exited', data=df)
plt.title('Saldo por Pa√≠s e Churn')
plt.show()

"""## üî¨ An√°lise Multivariada

Analisamos intera√ß√µes entre tr√™s ou mais vari√°veis.

"""

# Pairplot
sns.pairplot(df, vars=['Age', 'Balance', 'EstimatedSalary'], hue='Exited')
plt.show()

"""## üìç Principais Insights

- Clientes mais velhos tendem a sair mais do banco (Churn maior com idade elevada).
- A vari√°vel `Geography` mostra varia√ß√µes no churn ‚Äî clientes da Alemanha saem mais.
- N√£o h√° correla√ß√£o forte entre sal√°rio estimado e churn.
- A maioria dos clientes possui cart√£o de cr√©dito, mas isso n√£o garante reten√ß√£o.
- Clientes com apenas um produto banc√°rio t√™m maior taxa de sa√≠da.

## üß† Hip√≥teses

- Clientes com mais produtos t√™m menor propens√£o ao churn?
- A inatividade do cliente contribui fortemente para a sa√≠da?
- H√° algum limite de idade a partir do qual o risco de churn aumenta significativamente?


"""